# Распознавание кода Морзе из аудиосигналов

## Описание задачи

Цель проекта: построить алгоритм для декодирования кода Морзе из аудиофайлов.

Входные данные:
1. Датасет из 35000 аудиофайлов формата `.opus` с частотой дискретизации 8 кГц.
2. Тренировочная выборка с сообщениями (30000 файлов).

Метрика качества: усредненное расстояние Левенштайна.

Дополнительная задача: расшифровать последние 17 файлов тестовой выборки путём замены одних букв на другие.

## Решение

***Общая идея***

Использовать словарь Морзе.
Тем самым свести предсказание к 5 классам:
1) Точка
2) Тире
3) Разделитель между символами
4) Разделитель между словами
5) Шум

Использовать архитектуру CRNN, широко применяемую при работе с аудиофайлами.

**1 этап**
***Извлечение признаков***

Для извлечения признаков из аудиофайлов была использована мелспектрограмма и хромограмма.
Из мелспектрограммы были взяты значения из 3 наиболее сильных частоты по mel-шкале и наибольшие значения по каждому временному шагу.
Из хромограммы было получено среднее значение из 8 хромов, исключая наиболее плотный, на котором идет сигнал.

Тем самым получены значения, где есть сигнал и где его нет.
Дополнтиельно был подготовлен файл с извлеченными признаками.

**2 этап**
***Разработка алгоритма дешифровки кода Морзе***

Была разработана следующая нейросетевая модель:
1) Сверточный блок для каждого временного шага для выявления наличия сигнала/тишины
2) Каскадный свёртки для выявления временных зависимостей (получения пробела/тире/точки)
3) Двойной BiGRU для получения связей между значения по временной шкале
4) Классификатор с 5 выходами

Использовалась функция потерь CTCLoss

**3 этап**
***Обучение и предсказание***

Модель обучалась на 29000 файлах, на 1000 проводилась валидация. Такой метод был выбран, поскольку структура сигналов кодам Морзе достаточно схожая и несильно меняется от одного файла к другому.

Предсказание строилось путём обратного декодирования полученных точек и тире.

## Результаты

Public score: 0.45257

Private score: 0.46138
